"use strict";(()=>{var e={};e.id=507,e.ids=[507],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},9054:(e,t,n)=>{n.r(t),n.d(t,{config:()=>c,default:()=>d,routeModule:()=>f});var o={};n.r(o),n.d(o,{default:()=>p});var r=n(1802),i=n(7153),a=n(6249);let l=null,u=null;async function s(){let e=Date.now();if(l&&u&&e-u<6e5)return l;let t=await fetch("https://openrouter.ai/api/v1/models");if(!t.ok)throw Error("Failed to fetch OpenRouter models");let n=await t.json(),o={};if(Array.isArray(n.data))for(let e of n.data)o[e.id]=e;return l=o,u=e,o}async function p(e,t){if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});let{apiKey:n,model:o,prompt:r,max_tokens:i=1024}=e.body;if(!n||!o||!r)return t.status(400).json({error:"Missing required fields"});try{Date.now();let e=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({model:o,messages:[{role:"user",content:r}],max_tokens:i})}),a=await e.json(),l=a.choices?.[0]?.message?.content||"",u=a.id,p=a.provider||null,d=a.model||o,c=null,f=!1,h=null,P=null;if(u)try{let e=await fetch(`https://openrouter.ai/api/v1/generation/${u}`,{method:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}}),t=await e.text();if(e.ok){let e=JSON.parse(t);c={input_tokens:e.input_tokens,output_tokens:e.output_tokens,total_tokens:e.total_tokens}}else f=!0}catch(e){f=!0}else f=!0;if(f)try{let e=(await s())[d];e&&(h=e.context_length||null,P=e.pricing||null)}catch(e){}t.status(200).json({output:l,usage:c,contextLength:h,pricing:P,statsUnavailable:f,provider:p,model:o})}catch(e){t.status(500).json({error:"Failed to fetch from OpenRouter"})}}let d=(0,a.l)(o,"default"),c=(0,a.l)(o,"config"),f=new r.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/openrouter-completion",pathname:"/api/openrouter-completion",bundlePath:"",filename:""},userland:o})},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var n=t(t.s=9054);module.exports=n})();